/*--------------------------------------------------------
 * Author Trần Đức Tiến
 * Email tientran0019@gmail.com
 * Phone 0972970075
 *
 * LastModified: 2019-03-27 13:42:52
 *-------------------------------------------------------*/

import AuthStorage from 'app/utils/auth.storage';

import { SINGLE_API } from 'app/redux/actions/type';

export function loginRequest(payload, next, nextErr) {
	return {
		type: 'LOGIN_REQUEST',
		payload,
		next,
		nextErr,
	};
}

export function logoutRequest(next) {
	return {
		type: 'LOGOUT_REQUEST',
		next,
	};
}

export const getUserAuth = (payload, next, nextErr) => {
	return {
		type: 'GET_USER_AUTH_REQUEST',
		next,
		nextErr,
	};
};

export const resetPassword = (payload, next, nextError) => {
	return {
		type: SINGLE_API,
		payload: {
			uri: '/users/reset-password?access_token=' + payload.token,
			params: { newPassword: payload.password },
			opt: { method: 'POST' },
			afterSuccess: next,
			afterError: nextError,
		},
	};
};

export const forgotPassword = (payload, next, nextError) => {
	return {
		type: SINGLE_API,
		payload: {
			uri: '/users/reset',
			params: { email: payload.email },
			opt: { method: 'POST' },
			afterSuccess: next,
			afterError: nextError,
		},
	};
};

export const changePassword = (payload, next, nextError) => {
	const { oldPassword, newPassword } = payload;
	return {
		type: SINGLE_API,
		payload: {
			uri: '/users/change-password',
			params: { oldPassword, newPassword },
			opt: { method: 'POST' },
			afterSuccess: next,
			afterError: nextError,
		},
	};
};

export const updateProfile = (payload, next, nextError) => {
	return {
		type: SINGLE_API,
		payload: {
			uri: '/users/' + AuthStorage.userId,
			params: payload,
			opt: { method: 'PATCH' },
			successType: 'UPDATE_PROFILE_SUCCESS',
			afterSuccess: next,
			afterError: nextError,
		},
	};
};
